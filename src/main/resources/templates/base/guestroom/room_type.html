<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8"></meta>
<title>room_type</title>
<div class="page-header">
	<h1>
		客房管理 <small> 》客房类型管理 </small>
	</h1>
</div>

<!-- 按钮组 -->
<div class="row">
	<div class="col-xs-12">
		<button class="btn btn-info no-border" data-toggle="modal"
			data-target="#editModal" id="create-roomType-btn">
			<i class="ace-icon fa fa-plus bigger-120" />新建
		</button>
		<button class="btn btn-danger no-border" id="deleteAll-roomType-btn">
			<i class="ace-icon fa fa-trash-o bigger-120" />删除
		</button>
		<!-- /.btn-group -->
	</div>
</div>
<!-- [End].row -->

<!-- 列表主题内容 -->
<div class="row">
	<div class="col-xs-12">
		<div class="table-header">客房类型列表</div>
		<!-- <div class="table-responsive"> -->

		<!-- <div class="dataTables_borderWrap"> -->
		<div>
			<table id="sample-table"
				class="table table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th class="center"><label class="position-relative">
								<input type="checkbox" class="ace" /> <span class="lbl"></span>
						</label></th>
						<th>类型编号</th>
						<th>类型名称</th>
						<th class="hidden-480">额定人数</th>
						<th>
							<!-- <i class="ace-icon fa fa-clock-o bigger-110 hidden-480"></i> -->
							备注
						</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="roomType : ${roomTypes}">
						<td class="center"><label class="position-relative">
								<input type="checkbox" class="ace" th:id="${roomType.id}"
								name="del-roomType-checkbox" /> <span class="lbl"></span>
						</label></td>
						<td><a href="#" th:text="${roomType.serialNo}">roomType.serialNo</a></td>
						<td th:text="${roomType.typeName}">roomType.typeName</td>
						<td class="hidden-480" th:text="${roomType.maxPeople}">roomType.maxPeople</td>
						<td th:text="${roomType.remarks}">roomType.remarks</td>
						<td>
							<div class="hidden-sm hidden-xs action-buttons">
								<a class="green" href="#" name="update-roomType-btn"
									th:id="${roomType.id}" data-toggle="modal"
									data-target="#editModal"> <i
									class="ace-icon fa fa-pencil bigger-130"></i>
								</a> <a class="red" href="#" th:id="${roomType.id}"
									name="delete-roomType-btn"> <i
									class="ace-icon fa fa-trash-o bigger-130"></i>
								</a>
							</div>

							<div class="hidden-md hidden-lg">
								<div class="inline position-relative">
									<button class="btn btn-minier btn-yellow dropdown-toggle"
										data-toggle="dropdown" data-position="auto">
										<i class="ace-icon fa fa-caret-down icon-only bigger-120"></i>
									</button>

									<ul
										class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">

										<li><a href="#" class="tooltip-success"
											data-rel="tooltip" title="Edit" name="update-roomType-btn"
											th:id="${roomType.id}"> <span class="green"> <i
													class="ace-icon fa fa-pencil-square-o bigger-120"></i>
											</span>
										</a></li>

										<li><a href="#" class="tooltip-error" data-rel="tooltip"
											title="Delete" th:id="${roomType.id}"
											name="delete-roomType-btn"> <span class="red"> <i
													class="ace-icon fa fa-trash-o bigger-120"></i>
											</span>
										</a></li>
									</ul>
								</div>
							</div>
						</td>
					</tr>

					<tr th:remove="all">
						<td class="center"><label class="position-relative">
								<input type="checkbox" class="ace" /> <span class="lbl"></span>
						</label></td>

						<td><a href="#">best.com</a></td>
						<td>$75</td>
						<td class="hidden-480">6,500</td>
						<td>Apr 03</td>
						<td>
							<div class="hidden-sm hidden-xs action-buttons">
								<a class="blue" href="#"> <i
									class="ace-icon fa fa-search-plus bigger-130"></i>
								</a> <a class="green" href="#"> <i
									class="ace-icon fa fa-pencil bigger-130"></i>
								</a> <a class="red" href="#"> <i
									class="ace-icon fa fa-trash-o bigger-130"></i>
								</a>
							</div>

							<div class="hidden-md hidden-lg">
								<div class="inline position-relative">
									<button class="btn btn-minier btn-yellow dropdown-toggle"
										data-toggle="dropdown" data-position="auto">
										<i class="ace-icon fa fa-caret-down icon-only bigger-120"></i>
									</button>

									<ul
										class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
										<!-- <li><a href="#" class="tooltip-info" data-rel="tooltip"
											title="View"> <span class="blue"> <i
													class="ace-icon fa fa-plus bigger-120"></i>
											</span>
										</a></li> -->

										<li><a href="#" class="tooltip-success"
											data-rel="tooltip" title="Edit"> <span class="green">
													<i class="ace-icon fa fa-pencil-square-o bigger-120"></i>
											</span>
										</a></li>

										<li><a href="#" class="tooltip-error" data-rel="tooltip"
											title="Delete"> <span class="red"> <i
													class="ace-icon fa fa-trash-o bigger-120"></i>
											</span>
										</a></li>
									</ul>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
			<!-- sample-table -->
		</div>
	</div>
</div>

<!-- 信息编辑模态框 -->
<!-- Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog"
	aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">
					<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">客房类型编辑</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-xs-12">
						<!-- 表单主体 -->
						<form class="form-horizontal" role="form" id="form">
							<input type="hidden" name="id" />
							<!-- #section:elements.form -->
							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right"
									for="form-field-1"> 类型编号： </label>

								<div class="col-sm-8">
									<input type="text" id="serialNo" placeholder="类型编号"
										class="col-xs-10 col-sm-5" name="serialNo" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right"
									for="form-field-1"> 类型名称： </label>

								<div class="col-sm-8">
									<input type="text" id="form-field-1" placeholder="客房类型名称"
										class="col-xs-10 col-sm-5" name="typeName" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right"
									for="form-field-1"> 额定人数： </label>
								<div class="col-sm-8">
									<input type="text" class="input-mini" id="spinner3"
										name="maxPeople" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right"
									for="form-field-1"> 备注： </label>
								<div class="col-sm-8">
									<textarea class="form-control" id="form-field-8"
										placeholder="备注" name="remarks"></textarea>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
				<button type="button" id="roomType-btn" name="save"
					class="btn btn-primary" data-dismiss="modal">
					<i class="ace-icon fa fa-floppy-o bigger-120"></i>保存
				</button>
			</div>
		</div>
	</div>
</div>
<!-- /.modal -->


<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
	var script = [ null, "/static/custom/common/simple-table.js", null ]
	$.ace_ajax_finish(script, function() {
		jQuery(function($) {

			/** 初始化数据 **/
			var data = /*[[${roomTypes}]]*/null;
			var jsonData = {};
			for ( var index in data) {
				var id = data[index].id;
				jsonData[id] = data[index];
			}

			var table = new SimpleTable();
			table.init("/base/roomtype", jsonData, "/base/roomtype/page/", 4); // 初始化表格

			table.addSaveMethod("create-roomType-btn", "roomType-btn", {
				"id" : "input",
				"serialNo" : "input",
				"typeName" : "input",
				"maxPeople" : "input",
				"remarks" : "textarea"
			}); // 添加保存操作

			table.addDelMethod("delete-roomType-btn", "del-roomType-checkbox",
					"deleteAll-roomType-btn"); // 添加删除操作

			table.addUpdateMethod("update-roomType-btn", "roomType-btn", {
				"id" : "input",
				"serialNo" : "input",
				"typeName" : "input",
				"maxPeople" : "input",
				"remarks" : "textarea"
			});// 添加修改操作
			
			$('#create-roomType-btn').click(function(){
				$('#form').validate().resetForm();
				$.ajax({
					url: "/base/roomtype/getSerialNo",
					type:'GET',
					dateType:'json',
					success:function(data){
						$('#serialNo').val(data);
					}
				})
				$('#serialNo').rules('add',validate_serialNo_rule) ;
			});
			
			$('roomType-btn').click(function(){
				if(!$('#form').valid()) {
                    return false ;
                }
			});
			
 			//校验楼层号的规则
                var validate_serialNo_rule = {
                		required: true,
                		digits: true,
						min: 1,
						rangelength:[1,15] ,
                    	remote: function() {
                        return '/base/roomtype/validation/'+$('#serialNo').val()
                    }
                } ;
			
			$('#form').validate({
				rules: {
					serialNo: validate_serialNo_rule,
				},
				messages: {
					serialNo: {
						required: '请输入客房类型编号',
						min: '输入值不能小于1',
						rangelength: '请输入一个长度介于 1 和 15 之间的数字' ,
						remote:'楼层号已存在',
					}
				}
			});
		})
	});
	/*]]>*/
</script>